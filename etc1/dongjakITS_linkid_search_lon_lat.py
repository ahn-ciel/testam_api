import pandas as pd
import numpy as np

# ROOT_PATH="/Users/jmahn/ciel/DATA"
# 링크 정보 (도로 구간), 노드 정보 (위도, 경도 포함)
# df_link = pd.read_csv(f"publicDB/kor_linkID_info_20250124_utf8.csv", encoding="utf-8") 
df_link = pd.read_csv(f"publicDB/kor_nodelink_info_2023_utf8.csv", encoding="utf-8") 
df_node = pd.read_csv(f"publicDB/seoul_nodeID_info.csv", encoding="utf-8")  

# 1479 ea - type: int 
link_ids=[1020000101, 1020000104, 1020000201, 1020000202, 1020000301, 1020000303, 1020002402, 1020002701, 1020002800, 1020004501, 1020023100, 1020023200, 1020023300, 1020023400, 1020023500, 1020023600, 1020023700, 1020024100, 1020024500, 1020024600, 1020024700, 1020024801, 1020024802, 1020025800, 1020025900, 1020026000, 1020051500, 1020054300, 1020054400, 1160275800, 1170006500, 1170006600, 1170008301, 1170008302, 1170008401, 1170008402, 1170008900, 1170009000, 1170026000, 1170026100, 1170044701, 1180000901, 1180000902, 1180001001, 1180001002, 1180005802, 1180005803, 1180005805, 1180005902, 1180005904, 1180006200, 1180006300, 1180006400, 1180006500, 1180006801, 1180006802, 1180006902, 1180006903, 1180007001, 1180007003, 1180007102, 1180007103, 1180007202, 1180007300, 1180007403, 1180007404, 1180007405, 1180007502, 1180007503, 1180007504, 1180007802, 1180007803, 1180007901, 1180007902, 1180008000, 1180008100, 1180008200, 1180008300, 1180008401, 1180008403, 1180008501, 1180008502, 1180008602, 1180008702, 1180008800, 1180008900, 1180009000, 1180009102, 1180009201, 1180009203, 1180009204, 1180009302, 1180009304, 1180009305, 1180009400, 1180009500, 1180009600, 1180009700, 1180010201, 1180010202, 1180010301, 1180010302, 1180010401, 1180010402, 1180010501, 1180010502, 1180010602, 1180010603, 1180010604, 1180010703, 1180010704, 1180010705, 1180011201, 1180011202, 1180011204, 1180011205, 1180011206, 1180011207, 1180011301, 1180011302, 1180011305, 1180011306, 1180011307, 1180011308, 1180011802, 1180011803, 1180011804, 1180011902, 1180011903, 1180011904, 1180012601, 1180012602, 1180012701, 1180012702, 1180012802, 1180012803, 1180012804, 1180012806, 1180012808, 1180012812, 1180012901, 1180012902, 1180012903, 1180012906, 1180012907, 1180012908, 1180012910, 1180013201, 1180013202, 1180013301, 1180013302, 1180013800, 1180013900, 1180014001, 1180014002, 1180014003, 1180014004, 1180014006, 1180014101, 1180014102, 1180014103, 1180014105, 1180015002, 1180015003, 1180015004, 1180015101, 1180015102, 1180015103, 1180016001, 1180016002, 1180016003, 1180016101, 1180016102, 1180016103, 1180016201, 1180016203, 1180016205, 1180016206, 1180016301, 1180016303, 1180016305, 1180016306, 1180017603, 1180017604, 1180017701, 1180017702, 1180017801, 1180017802, 1180017901, 1180017902, 1180018001, 1180018002, 1180018101, 1180018102, 1180018402, 1180018404, 1180018405, 1180018501, 1180018502, 1180018503, 1180018604, 1180018701, 1180018702, 1180019001, 1180019102, 1180019202, 1180019302, 1180019801, 1180019902, 1180021002, 1180021101, 1180041700, 1180043800, 1180043900, 1180044400, 1180044500, 1180044700, 1180044800, 1180048000, 1180048100, 1180048600, 1180048700, 1180048800, 1180048900, 1180049000, 1180049100, 1180049200, 1180049300, 1180049401, 1180049402, 1180049501, 1180049502, 1180049800, 1180049900, 1180050000, 1180050100, 1180050200, 1180050300, 1180050600, 1180050700, 1180051000, 1180051100, 1180051300, 1180051400, 1180051700, 1180051800, 1180051900, 1180052000, 1180052200, 1180052300, 1180052400, 1180052500, 1180052600, 1180052700, 1180052900, 1180053000, 1180053100, 1180053200, 1180053300, 1180053400, 1180053600, 1180053700, 1180053800, 1180053900, 1180054000, 1180054100, 1180054200, 1180054300, 1180054400, 1180054500, 1180054600, 1180054700, 1180055100, 1180055200, 1180055300, 1180055400, 1180055600, 1180055700, 1180055800, 1180055900, 1180056000, 1180056100, 1180056200, 1180056300, 1180056400, 1180056500, 1180056800, 1180056900, 1180057200, 1180057300, 1180057400, 1180057500, 1180057800, 1180057900, 1180058200, 1180058300, 1180058400, 1180058500, 1180058800, 1180058900, 1180059000, 1180059100, 1180059200, 1180059300, 1180059500, 1180059600, 1180059700, 1180059800, 1180059900, 1180060000, 1180060400, 1180060500, 1180060600, 1180060700, 1180061400, 1180061500, 1180061900, 1180062000, 1180062100, 1180062200, 1180062600, 1180062700, 1180063100, 1180063200, 1180063500, 1180063600, 1180063800, 1180064200, 1180064600, 1180064700, 1180065700, 1180065800, 1180067601, 1180067602, 1180067701, 1180067702, 1180067800, 1180067900, 1180069001, 1180069002, 1180069101, 1180069102, 1180070000, 1180070100, 1180070500, 1180070600, 1180070700, 1180070800, 1180071100, 1180071200, 1180071500, 1180071603, 1180072700, 1180073100, 1180073200, 1180120700, 1180120800, 1180120900, 1180121000, 1180121100, 1180121200, 1180121300, 1180121400, 1180121500, 1180121600, 1180121700, 1180121800, 1180122300, 1180122400, 1180122500, 1180122600, 1180123500, 1180123600, 1180124500, 1180124600, 1180125300, 1180125400, 1180125500, 1180125600, 1180125700, 1180125800, 1180125900, 1180126000, 1180127700, 1180127800, 1180128100, 1180128200, 1180128300, 1180128400, 1180130400, 1180130500, 1180130600, 1180130700, 1180130800, 1180130900, 1180131500, 1180131600, 1180131700, 1180131800, 1180131900, 1180132000, 1180132101, 1180133001, 1180133201, 1180133401, 1190000101, 1190000102, 1190000200, 1190000704, 1190000705, 1190000706, 1190000804, 1190000805, 1190000806, 1190001501, 1190001502, 1190001503, 1190001601, 1190001602, 1190001603, 1190001701, 1190001702, 1190001801, 1190001802, 1190001902, 1190001903, 1190001904, 1190002002, 1190002003, 1190002004, 1190002101, 1190002102, 1190002103, 1190002104, 1190002201, 1190002202, 1190002203, 1190002204, 1190002301, 1190002302, 1190002303, 1190002304, 1190002305, 1190002306, 1190002401, 1190002402, 1190002403, 1190002404, 1190002405, 1190002406, 1190002501, 1190002502, 1190002503, 1190002601, 1190002602, 1190002603, 1190002700, 1190002800, 1190002901, 1190002902, 1190002903, 1190002904, 1190003001, 1190003002, 1190003003, 1190003004, 1190003102, 1190003201, 1190003202, 1190003301, 1190003302, 1190003304, 1190003305, 1190003402, 1190003403, 1190003405, 1190003406, 1190003502, 1190003503, 1190003504, 1190003601, 1190003603, 1190003604, 1190003605, 1190003701, 1190003702, 1190003703, 1190003704, 1190003705, 1190003706, 1190003707, 1190003801, 1190003802, 1190003803, 1190003804, 1190003805, 1190003806, 1190003807, 1190003808, 1190003901, 1190003902, 1190003903, 1190004001, 1190004002, 1190004003, 1190004101, 1190004103, 1190004104, 1190004105, 1190004106, 1190004201, 1190004203, 1190004204, 1190004205, 1190004206, 1190004207, 1190004301, 1190004302, 1190004401, 1190004402, 1190004501, 1190004503, 1190004504, 1190004601, 1190004604, 1190004605, 1190004702, 1190004703, 1190004704, 1190004802, 1190004803, 1190004804, 1190004900, 1190005000, 1190005101, 1190005102, 1190005201, 1190005202, 1190005302, 1190005402, 1190005403, 1190005701, 1190005702, 1190005703, 1190005802, 1190005803, 1190005804, 1190005901, 1190005902, 1190006001, 1190006002, 1190006101, 1190006201, 1190006300, 1190006402, 1190006501, 1190006502, 1190006503, 1190006601, 1190006603, 1190006701, 1190006702, 1190006703, 1190006704, 1190006801, 1190006802, 1190006803, 1190006902, 1190006903, 1190007002, 1190007003, 1190007302, 1190007402, 1190007404, 1190007500, 1190007600, 1190007800, 1190007900, 1190008000, 1190008100, 1190008200, 1190008300, 1190008400, 1190008500, 1190008600, 1190008700, 1190008800, 1190008900, 1190009000, 1190009100, 1190009200, 1190009300, 1190009700, 1190009800, 1190009900, 1190010000, 1190010200, 1190010300, 1190010400, 1190010500, 1190010600, 1190010700, 1190010800, 1190010900, 1190011000, 1190011100, 1190011200, 1190011300, 1190011400, 1190011500, 1190011600, 1190011700, 1190011800, 1190011900, 1190012000, 1190012100, 1190012200, 1190012300, 1190012600, 1190012700, 1190012800, 1190012900, 1190013001, 1190013002, 1190013101, 1190013102, 1190013200, 1190013300, 1190013402, 1190013501, 1190013600, 1190013700, 1190014000, 1190014100, 1190014200, 1190014300, 1190014400, 1190014500, 1190014800, 1190014900, 1190015000, 1190015100, 1190015200, 1190015300, 1190015400, 1190015500, 1190015602, 1190015604, 1190015605, 1190015606, 1190015700, 1190015800, 1190015900, 1190016000, 1190016100, 1190016200, 1190016300, 1190016400, 1190016501, 1190016502, 1190016601, 1190016602, 1190016700, 1190016800, 1190016900, 1190017000, 1190017101, 1190017102, 1190017201, 1190017202, 1190017301, 1190017302, 1190017401, 1190017402, 1190017500, 1190017600, 1190017700, 1190017800, 1190017900, 1190018000, 1190018100, 1190018200, 1190018300, 1190018400, 1190018500, 1190018600, 1190018700, 1190018800, 1190018900, 1190019000, 1190019100, 1190019200, 1190019300, 1190019400, 1190019500, 1190019600, 1190019700, 1190019800, 1190019900, 1190020000, 1190020100, 1190020200, 1190020300, 1190020400, 1190020500, 1190020600, 1190020900, 1190021000, 1190021100, 1190021200, 1190021300, 1190021400, 1190021500, 1190021600, 1190021700, 1190021800, 1190021900, 1190022000, 1190022100, 1190022200, 1190022300, 1190022400, 1190022700, 1190022800, 1190022900, 1190023000, 1190023100, 1190023200, 1190023300, 1190023400, 1190023500, 1190023600, 1190023700, 1190023800, 1190023900, 1190024000, 1190024100, 1190024200, 1190024300, 1190024400, 1190024500, 1190024600, 1190024800, 1190024900, 1190025000, 1190025100, 1190025200, 1190025300, 1190025400, 1190025500, 1190025600, 1190025700, 1190025800, 1190025900, 1190026000, 1190026100, 1190026200, 1190026300, 1190026400, 1190026500, 1190026600, 1190026700, 1190026800, 1190026900, 1190027000, 1190027100, 1190027200, 1190027300, 1190027400, 1190027500, 1190027600, 1190027700, 1190027800, 1190027900, 1190028000, 1190028100, 1190028200, 1190028300, 1190028500, 1190028600, 1190028700, 1190028800, 1190028900, 1190029000, 1190029100, 1190029200, 1190029300, 1190029400, 1190029500, 1190029600, 1190029800, 1190029900, 1190030000, 1190030100, 1190030200, 1190030300, 1190030400, 1190030500, 1190030600, 1190030700, 1190030800, 1190030900, 1190031000, 1190031200, 1190031300, 1190031400, 1190031500, 1190031600, 1190031700, 1190031800, 1190031900, 1190032000, 1190032100, 1190032200, 1190032300, 1190032400, 1190032500, 1190032600, 1190032700, 1190032800, 1190032900, 1190033000, 1190033101, 1190033102, 1190033201, 1190033202, 1190033300, 1190033400, 1190033500, 1190033600, 1190033700, 1190033800, 1190033900, 1190034000, 1190034100, 1190034200, 1190034400, 1190034500, 1190034900, 1190035000, 1190035100, 1190035200, 1190035300, 1190035400, 1190035500, 1190035600, 1190035700, 1190035800, 1190035900, 1190036000, 1190036100, 1190036200, 1190036300, 1190036400, 1190036500, 1190036600, 1190036700, 1190036800, 1190036900, 1190037000, 1190037100, 1190037200, 1190037300, 1190037400, 1190037500, 1190037600, 1190037700, 1190037800, 1190038200, 1190038300, 1190038900, 1190039000, 1190039100, 1190039200, 1190039800, 1190039900, 1190040600, 1190040700, 1190040900, 1190041001, 1190041002, 1190041100, 1190041200, 1190041300, 1190041400, 1190041600, 1190041700, 1190041800, 1190041900, 1190042000, 1190042300, 1190042400, 1190042500, 1190042600, 1190042900, 1190043000, 1190043100, 1190043200, 1190043400, 1190043500, 1190043600, 1190044000, 1190044200, 1190044600, 1190044700, 1190044800, 1190044900, 1190045000, 1190045100, 1190045200, 1190045400, 1190045500, 1190045600, 1190045700, 1190045800, 1190045900, 1190046000, 1190046100, 1190046200, 1190046300, 1190046400, 1190046500, 1190046600, 1190046700, 1190046800, 1190046900, 1190047000, 1190047100, 1190047200, 1190047300, 1190047400, 1190047500, 1190047600, 1190047700, 1190047800, 1190047900, 1190048000, 1190048100, 1190048200, 1190048300, 1190048400, 1190048500, 1190048600, 1190048700, 1190048800, 1190048900, 1190049000, 1190049100, 1190049200, 1190049300, 1190049400, 1190049500, 1190049600, 1190049700, 1190049800, 1190049900, 1190050000, 1190050100, 1190050200, 1190050300, 1190050400, 1190050500, 1190050600, 1190050700, 1190050800, 1190050900, 1190051001, 1190051101, 1190051201, 1190051301, 1190051401, 1190051501, 1190051601, 1190051701, 1190051801, 1190051901, 1190052001, 1190052101, 1190052201, 1190052301, 1190052401, 1190052501, 1190052601, 1190052701, 1190052801, 1190052901, 1190053001, 1190053101, 1200000702, 1200000802, 1200000904, 1200001004, 1200001102, 1200001103, 1200001104, 1200001105, 1200001202, 1200001204, 1200001205, 1200001206, 1200001304, 1200001305, 1200001405, 1200001406, 1200001501, 1200001502, 1200001503, 1200001504, 1200001505, 1200001506, 1200001601, 1200001602, 1200001603, 1200001604, 1200001605, 1200001606, 1200001701, 1200001702, 1200001703, 1200001801, 1200001802, 1200001803, 1200001900, 1200002000, 1200002101, 1200002102, 1200002103, 1200002104, 1200002105, 1200002201, 1200002202, 1200002203, 1200002204, 1200002205, 1200002301, 1200002302, 1200002401, 1200002402, 1200002501, 1200002502, 1200002601, 1200002602, 1200002703, 1200002803, 1200002901, 1200002904, 1200002905, 1200002906, 1200002907, 1200003001, 1200003003, 1200003004, 1200003005, 1200003006, 1200003100, 1200003200, 1200003301, 1200003401, 1200003501, 1200003502, 1200003601, 1200003602, 1200003702, 1200003802, 1200003902, 1200003903, 1200004001, 1200004002, 1200004101, 1200004102, 1200004103, 1200004201, 1200004202, 1200004203, 1200004300, 1200004400, 1200004500, 1200004600, 1200004701, 1200004801, 1200004902, 1200005002, 1200005100, 1200005202, 1200005300, 1200005400, 1200005700, 1200005800, 1200005900, 1200006000, 1200006101, 1200006102, 1200006201, 1200006202, 1200006301, 1200006401, 1200006500, 1200006600, 1200006701, 1200006702, 1200006703, 1200006801, 1200006802, 1200006803, 1200006901, 1200006902, 1200006903, 1200007001, 1200007002, 1200007004, 1200007101, 1200007102, 1200007103, 1200007201, 1200007202, 1200007203, 1200007301, 1200007302, 1200007401, 1200007402, 1200007500, 1200007601, 1200007700, 1200007800, 1200007902, 1200007903, 1200008002, 1200008003, 1200008100, 1200008200, 1200008500, 1200008600, 1200008701, 1200008702, 1200008801, 1200008802, 1200009101, 1200009102, 1200009202, 1200009203, 1200009300, 1200009400, 1200009501, 1200009502, 1200009503, 1200009602, 1200009603, 1200009604, 1200009701, 1200009702, 1200009703, 1200009704, 1200009705, 1200009801, 1200009802, 1200009803, 1200009804, 1200009805, 1200009902, 1200009903, 1200009904, 1200010002, 1200010003, 1200010004, 1200010100, 1200010200, 1200010301, 1200010401, 1200010501, 1200010502, 1200010601, 1200010602, 1200010700, 1200010800, 1200011101, 1200011202, 1200011203, 1200011301, 1200011302, 1200011401, 1200011402, 1200011501, 1200011502, 1200011503, 1200011504, 1200011505, 1200011601, 1200011602, 1200011603, 1200011604, 1200011605, 1200011701, 1200011702, 1200011801, 1200011802, 1200012101, 1200012202, 1200012301, 1200012302, 1200012303, 1200012304, 1200012305, 1200012401, 1200012402, 1200012404, 1200012405, 1200012406, 1200012502, 1200012601, 1200025100, 1200025200, 1200026500, 1200026600, 1200027700, 1200027800, 1200027900, 1200028000, 1200028100, 1200028200, 1200028300, 1200028400, 1200028500, 1200028600, 1200028700, 1200028800, 1200028900, 1200029000, 1200029100, 1200029200, 1200029300, 1200029400, 1200029500, 1200029601, 1200029602, 1200029701, 1200029702, 1200029800, 1200029900, 1200030000, 1200030100, 1200030200, 1200030300, 1200030400, 1200030500, 1200030600, 1200030700, 1200030800, 1200030900, 1200031200, 1200031300, 1200031500, 1200031600, 1200031700, 1200031800, 1200031900, 1200032000, 1200032100, 1200032200, 1200032300, 1200032400, 1200032500, 1200032600, 1200032700, 1200032800, 1200032900, 1200033000, 1200033100, 1200033200, 1200033300, 1200033400, 1200033500, 1200033600, 1200033700, 1200033800, 1200033900, 1200034300, 1200034600, 1200034700, 1200035000, 1200035100, 1200035200, 1200035300, 1200035800, 1200035900, 1200036400, 1200036500, 1200036600, 1200036700, 1200036800, 1200036900, 1200037000, 1200037100, 1200037200, 1200037300, 1200037500, 1200037600, 1200037700, 1200037800, 1200037900, 1200038000, 1200038100, 1200038200, 1200038300, 1200038400, 1200038500, 1200038700, 1200038800, 1200038900, 1200039000, 1200039100, 1200039200, 1200039300, 1200039400, 1200039500, 1200039600, 1200039700, 1200039800, 1200039900, 1200040000, 1200040100, 1200040200, 1200040300, 1200040400, 1200040500, 1200040600, 1200040700, 1200040800, 1200040900, 1200041000, 1200041100, 1200041200, 1200041300, 1200041400, 1200041500, 1200041600, 1200041700, 1200041800, 1200041900, 1200042000, 1200042100, 1200042200, 1200042300, 1200042400, 1200042500, 1200042600, 1200042700, 1200043100, 1200043200, 1200043300, 1200043400, 1200043600, 1200043700, 1200043800, 1200043900, 1200044000, 1200044100, 1200044200, 1200044300, 1200044400, 1200044500, 1200044600, 1200044700, 1200044800, 1200044900, 1200045001, 1200045002, 1200045101, 1200045102, 1200045200, 1200045300, 1200045400, 1200045500, 1200046200, 1200046300, 1200046400, 1200051000, 1200051100, 1200051200, 1200051300, 1200051400, 1200051500, 1200051600, 1200051700, 1200052201, 1200052301, 1200052401, 1200052501, 1200052601, 1200052701, 1210004500, 1210004600, 1210008004, 1210008011, 1210008103, 1210008111, 1210010802, 1210010803, 1210010902, 1210010903, 1210013201, 1210013202, 1210013203, 1210013204, 1210013301, 1210013302, 1210013303, 1210013304, 1210016202, 1210016203, 1210016302, 1210016303, 1210017602, 1210017604, 1210017605, 1210017606, 1210017702, 1210017704, 1210017705, 1210017706, 1210019200, 1210019300, 1210021400, 1210021500, 1210021602, 1210021604, 1210021605, 1210021606, 1210021702, 1210021703, 1210021705, 1210021706, 1210021707, 1210022802, 1210022902, 1210023202, 1210023301, 1210024000, 1210024100, 1210027800, 1210027900, 1210040300, 1210040400, 1210040500, 1210040600, 1210040700, 1210040800, 1210041000, 1210041100, 1210041200, 1210041300, 1210041500, 1210041600, 1210042100, 1210042200, 1210044801, 1210044802, 1210044901, 1210044902, 1210048000, 1210048100, 1210048400, 1210048500, 1210049200, 1210049300, 1210054900, 1210055000, 1210055100, 1210055200, 1210055500, 1210058100, 1210058200, 1210058300, 1210059500, 1210060300, 1210066500, 1210162500, 1210162600, 1210178200, 1210178300]

results = []
for link in link_ids:
    # 링크 정보에서 해당 LINK_ID의 row 찾기
    link_row = df_link[df_link["LINK_ID"] == int(link)]  # link_id가 문자열일 경우 int 변환
    
    if not link_row.empty:
        # F_NODE, T_NODE 값 가져오기
        f_node = link_row.iloc[0]["F_NODE"]
        t_node = link_row.iloc[0]["T_NODE"]
        f_node_name = link_row.iloc[0]["F_NAME"]
        t_node_name = link_row.iloc[0]["T_NAME"]
        road_rank = link_row.iloc[0]["ROAD_RANK"]
        road_name = link_row.iloc[0]["ROAD_NAME"]
        road_len = link_row.iloc[0]["ROAD_len(m)"]
        
        # 노드 정보에서 F_NODE의 X, Y 좌표 찾기
        f_node_row = df_node[df_node["NODE_ID"] == f_node]
        t_node_row = df_node[df_node["NODE_ID"] == t_node]
        
        if not f_node_row.empty and not t_node_row.empty:
            f_x, f_y = f_node_row.iloc[0]["X"], f_node_row.iloc[0]["Y"]
            t_x, t_y = t_node_row.iloc[0]["X"], t_node_row.iloc[0]["Y"]
            
            results.append({
                "LINK_ID": link,
                "F_NODE": f_node, "F_NAME": f_node_name, "F_X": f_x, "F_Y": f_y,
                "T_NODE": t_node, "T_NAME": t_node_name, "T_X": t_x, "T_Y": t_y,
                "ROAD_RANK": road_rank, "ROAD_NAME": road_name, "ROAD_len(m)":road_len
            })
        else:
            print('empty_lilnk:',link)

# 결과를 데이터프레임으로 변환 후 출력
result_df = pd.DataFrame(results)
print(result_df.head())

# 결과 저장 (선택)
result_df.to_csv("cielDB/dongjakITS/dongjakITS_linkID_nodeID_coordinates.csv", index=False, encoding="utf-8")